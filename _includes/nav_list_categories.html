<nav class="nav__list">
  <h3 class="nav__title">{{ site.data.ui-text[site.locale].categories_label | default: "Categories" }}</h3>
  <div class="nav__items">
    {%- assign category_strings = "" -%}
    {%- for category in site.categories -%}
      {%- if category[1].size > 0 -%}
        {%- assign last_post_date = category[1].first.date | date: "%Y-%m-%d %H:%M:%S" -%}
        {%- assign category_name = category[0] -%}
        {%- capture category_string -%}{{ last_post_date }},{{ category_name }}{%- endcapture -%}
        {%- assign category_strings = category_strings | append: category_string | append: "@@" -%}
      {%- endif -%}
    {%- endfor -%}

    {%- assign sorted_categories_array = category_strings | split: "@@" | sort | reverse -%}

    {%- for category_string in sorted_categories_array -%}
      {%- if category_string != "" -%}
        {%- assign parts = category_string | split: "," -%}
        {%- assign category_name = parts[1] -%}

        {%- assign category_page = site.pages | where: "slug", category_name | first -%}
        {%- assign display_title = category_page.title | default: category_name -%}

        <a href="{{ category_page.url | relative_url }}" class="nav__item">{{ display_title }}</a>
      {%- endif -%}
    {%- endfor -%}
  </div>
</nav>